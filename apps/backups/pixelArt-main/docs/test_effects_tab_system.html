<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Effects Tab System Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #121217;
            color: #e0e0e0;
            padding: 20px;
        }

        .test-container {
            max-width: 600px;
            margin: 0 auto;
            background-color: #1a1a2e;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #333;
        }

        h1 {
            color: #00ff41;
            text-align: center;
            margin-bottom: 20px;
        }

        .test-section {
            margin-bottom: 20px;
            padding: 15px;
            background-color: #1a1a2e;
            border-radius: 6px;
            border: 1px solid #333;
        }

        .test-section h2 {
            color: #00d9ff;
            margin-top: 0;
            font-size: 18px;
        }

        .test-results {
            background-color: #121217;
            padding: 15px;
            border-radius: 4px;
            margin-top: 10px;
            border: 1px solid #444;
            max-height: 200px;
            overflow-y: auto;
        }

        .success {
            color: #00ff41;
            font-weight: bold;
        }

        .error {
            color: #ff006e;
            font-weight: bold;
        }

        .info {
            color: #00d9ff;
        }

        button {
            background-color: #00ff41;
            color: #000;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            margin: 5px;
            transition: all 0.3s ease;
        }

        button:hover {
            background-color: #00e63a;
            transform: translateY(-2px);
        }

        .tool-btn.active {
            color: #00ff41 !important;
            border: 2px solid #00ff41 !important;
            background: rgba(0, 255, 65, 0.2) !important;
            font-weight: bold !important;
        }

        .code-block {
            background-color: #121217;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 14px;
            overflow-x: auto;
            margin: 10px 0;
            border: 1px solid #444;
        }

        .sub-panel-section {
            margin-top: 15px;
            padding: 15px;
            background: #1a1a2e;
            border-radius: 6px;
            border: 1px solid #00ff41;
            transition: opacity 0.3s ease;
        }

        .sub-panel-section.hidden {
            display: none;
        }

        .sub-panel-section h3 {
            color: #00ff41;
            margin-top: 0;
        }

        #effects-buttons {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            flex-wrap: wrap;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>Effects Tab System Test</h1>

        <div class="test-section">
            <h2>Test Results</h2>
            <div class="test-results" id="testResults">
                <p>Running tests...</p>
            </div>
        </div>

        <div class="test-section">
            <h2>Manual Test</h2>
            <p>Click the buttons below to test the effects tab system:</p>

            <div id="effects-buttons">
                <button class="tool-btn" data-tool="tool" title="Mirror (X)" data-type="mirror"
                    data-tooltip="**Mirror Tool**" data-content="mirror-options">
                    Mirror
                </button>
                <button class="tool-btn" data-tool="tool" title="Dither (D)" data-type="dither"
                    data-tooltip="**Dither Tool**" data-content="dither-options">
                    Dither
                </button>
                <button class="tool-btn" data-tool="tool" title="Contrast" data-type="contrast"
                    data-tooltip="**Contrast Tool**" data-content="contrast-options">
                    Contrast
                </button>
                <button class="tool-btn" data-tool="tool" id="filtersBtn" title="Filters"
                    data-type="filters" data-tooltip="**Custom Filters**" data-content="filters-list">
                    Filters
                </button>
            </div>

            <!-- Sub-panel sections -->
            <div id="effects-panels">
                <div id="mirror-options" class="sub-panel-section hidden">
                    <h3>Mirror Options</h3>
                    <p>This is the mirror options panel. It should only be visible when the Mirror button is active.</p>
                    <div class="code-block">
                        Panel ID: mirror-options<br>
                        Class: sub-panel-section<br>
                        Status: Active
                    </div>
                </div>

                <div id="dither-options" class="sub-panel-section hidden">
                    <h3>Dither Options</h3>
                    <p>This is the dither options panel. It should only be visible when the Dither button is active.</p>
                    <div class="code-block">
                        Panel ID: dither-options<br>
                        Class: sub-panel-section<br>
                        Status: Active
                    </div>
                </div>

                <div id="contrast-options" class="sub-panel-section hidden">
                    <h3>Contrast Options</h3>
                    <p>This is the contrast options panel. It should only be visible when the Contrast button is active.</p>
                    <div class="code-block">
                        Panel ID: contrast-options<br>
                        Class: sub-panel-section<br>
                        Status: Active
                    </div>
                </div>

                <div id="filters-list" class="sub-panel-section hidden">
                    <h3>Filters List</h3>
                    <p>This is the filters list panel. It should only be visible when the Filters button is active.</p>
                    <div class="code-block">
                        Panel ID: filters-list<br>
                        Class: sub-panel-section<br>
                        Status: Active
                    </div>
                </div>
            </div>
        </div>

        <div class="test-section">
            <h2>Expected Behavior</h2>
            <ul>
                <li class="info">✓ Only one sub-panel should be visible at a time</li>
                <li class="info">✓ Clicking a button should hide all other panels and show the corresponding one</li>
                <li class="info">✓ The active button should have visual feedback (border, color change)</li>
                <li class="info">✓ All panels should be hidden by default except the initial active one</li>
            </ul>
        </div>
    </div>

    <script>
        // RightPanelManager implementation
        class RightPanelManager {
            constructor() {
                this.activeEffectsTab = 'mirror'; // Default active tab
                this.init();
            }

            init() {
                this.bindEvents();
                // Set initial active tab
                this.setActiveEffectsTab(this.activeEffectsTab);
            }

            /**
             * Set active effects tab
             */
            setActiveEffectsTab(tabType) {
                // Hide all sub-panels (using the correct selector)
                const allPanels = document.querySelectorAll('.sub-panel-section');
                allPanels.forEach(panel => {
                    panel.classList.add('hidden');
                });

                // Show selected panel
                const selectedPanel = document.getElementById(this.getPanelId(tabType));
                if (selectedPanel) {
                    selectedPanel.classList.remove('hidden');
                    this.logTest(`✓ Panel "${tabType}" is now visible`, 'success');
                } else {
                    this.logTest(`✗ Panel for "${tabType}" not found!`, 'error');
                }

                // Update button highlighting (using the correct selector)
                const allButtons = document.querySelectorAll('.tool-btn[data-type]');
                allButtons.forEach(button => {
                    if (button.dataset.type === tabType) {
                        button.classList.add('active');
                    } else {
                        button.classList.remove('active');
                    }
                });

                this.activeEffectsTab = tabType;
                console.log(`Tab changed to: ${tabType}`);
            }

            /**
             * Get panel ID for effect type
             */
            getPanelId(effectType) {
                const panelMap = {
                    'mirror': 'mirror-options',
                    'dither': 'dither-options',
                    'contrast': 'contrast-options',
                    'filters': 'filters-list'
                };
                return panelMap[effectType];
            }

            /**
             * Bind events
             */
            bindEvents() {
                // Effects panel button clicks
                document.addEventListener('click', (e) => {
                    const effectButton = e.target.closest('.tool-btn[data-type]');
                    if (effectButton) {
                        e.preventDefault();
                        const effectType = effectButton.dataset.type;
                        this.setActiveEffectsTab(effectType);
                    }
                });
            }

            /**
             * Log test results
             */
            logTest(message, type = 'info') {
                const testResults = document.getElementById('testResults');
                const p = document.createElement('p');
                p.className = type;
                p.textContent = message;
                testResults.appendChild(p);
            }
        }

        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', () => {
            const testResults = document.getElementById('testResults');
            testResults.innerHTML = '<p class="success">✓ RightPanelManager initialized successfully!</p>';

            window.rightPanelManager = new RightPanelManager();

            // Run automated tests
            setTimeout(() => {
                testResults.innerHTML += '<p class="info">--- Running Automated Tests ---</p>';

                // Test 1: Check if mirror is active by default
                const mirrorPanel = document.getElementById('mirror-options');
                const mirrorBtn = document.querySelector('[data-type="mirror"]');
                if (!mirrorPanel.classList.contains('hidden') && mirrorBtn.classList.contains('active')) {
                    testResults.innerHTML += '<p class="success">✓ Test 1: Mirror tab active by default</p>';
                } else {
                    testResults.innerHTML += '<p class="error">✗ Test 1: Mirror tab not active by default</p>';
                }

                // Test 2: Check if other panels are hidden
                const otherPanels = document.querySelectorAll('.sub-panel-section:not(#mirror-options)');
                let allHidden = true;
                otherPanels.forEach(panel => {
                    if (!panel.classList.contains('hidden')) allHidden = false;
                });
                if (allHidden) {
                    testResults.innerHTML += '<p class="success">✓ Test 2: Other panels hidden by default</p>';
                } else {
                    testResults.innerHTML += '<p class="error">✗ Test 2: Some panels not hidden</p>';
                }

                testResults.innerHTML += '<p class="info">--- Tests Complete ---</p>';
            }, 100);
        });
    </script>
</body>
</html>